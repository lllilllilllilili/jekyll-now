---
post : layout
title : 데이터통신5
---
## 복습
서킷 스위칭을 배웠고 이제
버츄얼 서킷 = 가상 회선망에 대해서 배우도록 한다
이 말그대로 서킷을 흉내낸 패킷 교환기다
그래서 회선교환기를 흉내낸 패킷 교환기임
가상 회선 네트워크에서는 이미 본거같음
복습 삼아 정리해보면 가상 회선 네트워크에 특성이라고 하는게 알고보면 회선 교환 네트워크의 특성을 많이 가지고 왔음
포워드 설정 해제 단계가 있고 
자료를 할당해주는데 설정단계에서 할당할 수도있고 on-demand 방식으로 할당할 수도 있다.
데이터 그램 네트워크와 같이 패킷으로 전송이 되고 각 패킷은 개별적으로  처리가 되는데 각각 헤더에 주소를 담고있다.
또 회선교환처럼 연결 설정되고 나면 하나의 경로가 설정되기떄문에 하나의 연결에 해당하는 모든 데이터는 패킷은 같은경로를 따라 전송이 된다. 마치 회선교환하고 똑같음
그리고 가상회선 스위칭은 데이터링크층에서 구현된다.
가상회선 스위칭이 네트워크 계층에서는 구현된다고 말안하고 데이터링크 계층에서 구현이됨
여기넘어가고
가상회선네트워킹에서 주소가 두가지가 활용이 되는데 
전력주소 
마치 그 ip 주소와 같이 그 전 지구적으로 유일하게 구별이되는 주소를 전역주소라고함 
목적지는 전지구상에 특정한 한곳이기 떄문에 바로 이 목적지 주소가 전역주소?? 가 되는거고 
가상회선 식별자라고 해서 그 가상회선 스위칭이 이루어지게끔 활용하는 로컬 에서만 의미가 있는 어떤 식별자 내지는 이 패킷의 아이디라고 보면된다.
그 패킷이 일단 회선이 설정되고 났을때 가는모양은 이런 모양이 됨 
데이터그램 식별자 vci라고 하는게 따라가는데 이렇게 가면은 스위치 하나 거쳐갈때마다 그값이 바껴서 간다. 
## 가상회선 네트워크
바껴서 그다음 스위치로 간다 이게 이 요게 바로 vci 로컬한 개념, 가상 회선 식별자라고 하는 이 부분은 교환기에서 사용하는 주소 다시말해서 그게 의미있는 바는 이 교환기 안에서만 14번이 의미가 있음 다른 스위치로 가면 이 14번은 또 다른 의미가 있기떄문에 이 요스위치에서만 의미있는 주소 로컬 meaning을 갖는 주소임
그리고 이 스위치는 보면은 14번이라는 vci를 가지고 오면은
외부로보낼때는 77번이라는 vci로 바꿔서 보냄 77번은 이 뒤에있는 스위치에게 또 의미가 있는 주소가 됨 얘는 77번은 어디로 보내야 한다라는것을 알고있는 스위치고 얘는 14번을 어디로 보내야한다라고 하는 알고있는 스위치임
그 스위치 에서만 의미있는 주소들이 vci임 
그리고 각 스위치에는 바로 어느 포트에 어느 vci로 들어오는 패킷은 어느 포트에 어느 vci로 바꿔서 보내야 된다라고 하는 이 테이블이 있는거임

## 가상회선 네트워크(2)
그래서 이 스위치를 보면 보다싶이 1번 포트로 14번을 가지고 들어온 패킷이 들어왔음
표에 의해서 3번포트에 22번 vci로 바꿔서 내보내야 한다는 이 표에 의해서 이 패킷이 요리로 가고 이 패킷은 77번이 왔죠 1번포트에 얘는 2번 포트에 41번을 갖고 내보낸다. 이렇게 표가 만들어져있음 이 표는 누가 만드냐고 하면 바로 설정단계에서 만들어진다. 이 가상회선 스위칭은 설정과 해제 단계가 있다고 했는데 설정, 우리가 회선교환에서 내가 전화번호를 051 누르면 이 전화번호 기반으로 각 스위치가 이 자원을 이 call 에게 할당해주기 위해서 자기가 채널을 얘한테 할당해주는 과정에 있었죠 그런 과정이 이 버츄얼 서킷 스위치 에서도 설정단계에서 이런 표가 만들어진다.


## 가상회선 네트워크(3)
설정단계에서 어떤식으로 저표가 만들어지는데 뒤에 가서 상세하게 설명이 됨
이 표가 있다는 가정하에 이 쭉 전달되는 모양을 보면은 여기서 이리로 가는 
A->B로 가는 패킷이 결국 이리로 가야하는데 최종 목적지 주소가 없음 
B가 없는데도 이 싀위치는 1번 의 14번 가지고 오면은 3번 66번으로 보내고 이 스위치는 얘한테 3번 포트지만 얘한테는 1번 포트에요
각 스위치마다 자기가 관리하는 링크의 아이디는 다름 얘는 3번이지만 1번임
1번 66번 으로 들어온 놈은 2번에 22 번으로 보낸다. 
얘는 2번 22번으로 들어온 패킷은 3의 77로 보낸다. 
3번링크가 곧 B로 ?? 되어있는 링크다.
그 미리 이런 표가 만들어졌다라는것을 미리 패스가 형성이 되어있다. 우리가 결국은 관심가져야 할것은 저 표가 어떻게 만들어졌는가 를 과정을 살펴봐야 한다. 그 과정이 남은거임
여기에 이부분은 콜을 설정해가는 테이블 만들어가는 과정을 살펴본다.

## 가상회선 네트워크(4)
먼저 이 인제
a가 b에게 패킷을 보내는데 물론 여기는 지금
구체적인 상세한 완벽한 정보는 없지만 얘는 적어도 이 표 외에 또다른 표를 가지고 있는데
a는 이 설정단계에서 뭐 요청하냐면 이 패킷은 이 b라고 하는 글로벌 어드레스를 여기다 일단 제시를 해줘야함 
그래야 얘도 그 이 b를 가기 위해선 이 3번을 가야될지 다른 곳으로 가야할지 또다른 라우팅 테이블을 가지고 인제 판단을 함 그래서 실제 버츄얼 서킷이 이루어질려면 그전에 이미 
이 라우팅 테이블, 포워딩 테이블 도 또 있어야함 글로벌 어드레스에 관한 그 포워딩 패스 가 되지는지를 얘가 또 알고있어야함

이 그림에서는 그거를 알고있다는 가정하에 진행
맨처음 a가 b한테 뭔가 보내고자 할떄는 당연히 a는 내가 글로벌 어드레스고 목표어드레스는 b인데 이 패킷을 보내달라고 버츄얼 서킷 스위칭에 요청을 함 
그러면 이렇게 이 스위칭입장에서 1번 포트로 왔어 
그러면 이 스위치는 아 이제 여기서 이리로 갈 패킷에 대해서는 내가 이 요 
들어오는 쪽에 vci를 14번이라는 것이 이제 유용하기 떄문에 내가 지금 가용하기떄문에 이 패킷을 1-14로 셋팅 을 해두는거임 여기로 들어오는 놈을 
1-14번이 되겠고 
내가 셋팅을 해놓음 그리고 나서 라우팅 테이블을 보니까 이리로 갈려면 3-?? 3번포트로 
내보내야 되겠다고 해서 3번 포트로 내보내는데 마찬가지로 이 요청 파일을 3번 포트로 내보내는데 이 이 vci는 달고갈 vci는 이 받을 스위치에서 유용한것이다. 필요한것임
이 스위치는 아직 바꿔서 보낼 vci를 모르는거임 얘가지금 할당해주는 vci를 나중에 여기다 채워넣서 보낼 생각을 하는거임 일단 3번포트로 요청 패킷을 보냄 그러면 이 패킷은 b라는 하는것은 글로벌 어드레스를 가지고 있음
이 스위치는 마찬가지로 여기서 온 패킷은 자기 스위치입장에서 1번 포트로왔고 내가 1번포트에 지금 가용한 vci가 66번 이다라고 하면 요렇게 채워넣고 
채운 다음에 라우팅 테이블을 보니까 이리로 갈려면 2번으로 내보내야 하겠다 
그래서 포트는 2번으로 내보내는데 역시 vci 는 몇번으로 넣어서 패킷을 앞으로 보낼지 모르는거임 여기서는 나중에 받아야 하는거기때문에 
보내고 똑같은일을 하게된다. 이 스위치도 2번에 들어온놈을 가용할 vci를 22번 할당을 해서 표를 채우고 목적지를 보니까 3번으로 나가야겠다 라고 해서 3번으로 
3번을 내보내서 결국 b까지 감 
목적지 임 b가 
자그럼 b가 이제 피드백 되는 정보를 여기서 시작을 하게됨
b라는 내가 지금 가용한 vci가 77번이다  라고 하면 그럼 바로 요자리에 채워넣을 vci number를 거꾸로 알려줘야 함
그다음 순서가 b는 
이리로 보낼떄 77번 을 넣어서 보내라 라고 77 넣어서 보내라 라고 77을 보내고 
그러면은 이 스위치는 77을 채웠음 그리고 거꾸로 보내면서 내가 아까 이 가용할 채널이 22번이이었음 vci가 22라는 숫자를 보내면은 이 스위치는 여기 22를 채우고 

또 이스위치 입장에서 66이 가용했기 때문에 66으로 보내라 라고 알려주면 얘는 66으로 채우고 해서 마지막으로 아까 14번이라는 vci를 알려주면 이제는 a는 지금 부터는 b로 가는 패킷을 구지 b라는 글로벌 어드레스를 안쓰고 이 링크에 14라고 만 달아서 보내면 그러면 저절로 14는 66이되고 66은 22가 되고 22는 77이되서 여기 도착을 하면 도착을 하게 된다.
call 설정이 바로 이 14번이라는 것이 a에 도착하기까지가 call 설정임 
그렇게 됬을때 우리가 뭘 볼 수 있냐면 각 스위치에 테이블 이 하나씩 
이 테이블에 entry가 하나씩 생긴거임
a에서 b까지 가기위한 vci 가 계속 변해가는데 어떤 테이블이 완성이 됨
이게 call 설정이 끝난거임
그다음부터는 이 a는 여기보낼때 vci만 갖고 보내면 된다. 
14번 
그러면 저절로 쭉해서 표현이 되서 여기까지 가는거임

우리가 구지 vci를 그 선호한 이유 목적지 어드레스를 대신해 vci 를 선호하는 이유는 간단함
글로벌 어드레스 라고 하는곳은 전세계 유일하게 해야하기때문에 굉장히 길이가 길어야함
길이가 
우리가 ip addr가 32bit인데 지금 전세계에 그 40억개 이상에 장치가 생기면은 거기에 고갈이 된다고 했음
그럼 더욱 사이즈를 키워야함
글로벌 하게 유니크 어드레스는 길이가 길어야 하는데 vci는 요 스위치 안에서만 의미가 있음
따라서 요 스위치가 요링크에 들어오는 각 호들에 대해서 어사인하는 값이기떄문에 
요 하나에 링크에 많아 봐야 몇천개 몇만개 들어올수있다고 그러면 
고정도 길이만 가지면 된다 
그런게 vci가 되는거임
패킷들이 구지 그런 address 필용없이 짧은 vci를 갖고 전송이 되도 주어진 패스를 따라서 전송을목적지 갈 수 있다. 이런 그 효율성이 증가됨
그리고 내가 항상 같은 길을 가고 있고 스위치들은 이렇게 entry 들을 테이블 에 넣단 얘기는 적어도 이 호에 대해서는 내가 뭔가를 보장해주겠다 라는것을 그 서포트 되는 뒤에 알고리즘들이 있는것임 
이 호들은 가령 이런거임
가령, 이 링크에 지금 66을 줬단 얘기는 이 링크에 줄수있는 그 제한 이 있을텐데 그 제한 안에서 주는거임 
지금 vci를 줄수있는 범위를 넘어섰다고 그러면은 못준다 라고 한다라는거임 
채널이 없을때 congestion control 울리듯이 여기도 마찬가지임 
그얘기는 다시말해서 이 억셉트된 호에 대해서 자원을 내가 줄 게 있다라는게 확인됬어다 라는거임 따라서 호설정이 완료되면 그호는 자원이 내가 설정단계에서 어사인되든 아니면 
미리 어사인된게 아니라 패킷이 일단 오면 그떄 내보내면서 어사인 되든 on-demand 방식이든 미리 주든 어쨋든 자원이 나한테 보증이 됬다라고 얘기 할 수 있고 
따라서 호에 퀄리티 를 좋아지는거임 데이터를 확 줄여주는거니까
회선교환이나 거의 다름없는 서비스를 부과할 수 있다.
이 패킷 스위치에 대해서
패킷 스위치는 전혀 이런 
데이터 그램 네트워크에서는 이런 호설정과정없이 그냥 무조건 목적지 주소를 가지고패킷을 집어넣으면 각각에 스위치들이 알아서 그다음단계보내고 보내고
보낼길이없으면 그냥 여기서 버려지게 되는거고 이런 일이 이루어진다. 
굉장히 회선교환에 가까운 그 좋은 퀄리티 서비스를 얻어낼 수 있다.
네트워킹이다.

## 질문
호설정 과정에서는 
가상회선 스위칭이 데이터링크에서 이루어지는 스위칭이라고 하는데 
데이터링크에서 이루어진다고 하는데 막상 호설정단계에서 보면 이 목적지의 글로벌 주소가 있어야 이 길이 만들어진다고 설명했음
그러면 글로벌 한 주소를 필요로 하기떄문에 네트워크 레이어에서 이루어지는 스위칭이 아니냐 
맞지
호설정 단계에서는 이 글로벌 한 주소를 갖고 호설정이 이루어지기 떄문에 호설정은 글로벌 한정보를 이용할 수밖에없음
네트워크 정보임
얘의 주소는 글로벌한 주소는 네트워크 레이어에 있는거임 
전세계 유일하게 가지고 있는 이거는 네트워크 레이어에서 관리하고 사용하는 주소다 이거임 
호설정단계는 
컨트롤 플레이드 
우리가 스위치를 애기할떄 스위치를 기능을 프로토콜 스택을 쭉 얘기할떄 
이렇게 피지컬 레이어 데이터 링크 레이어 네트워크 레이어 이렇게 얘끼하는데 
이거는 데이터 컨트롤 , 데이터 컨트롤 데이터 매니지 먼트 
라고 부르고 여기는 컨트롤 파트인데 그러니까 여기 데이터 처리 하는 기능은 
이렇게 스택으로 나눠져 있는데 
어떤 저런 호설정이나 이런것은 실제 호를 관리하고 제어하고 하는 컨트롤기능은 
전 영역에서 이렇게 쭈욱 퍼져있는 식으로 컨트롤 기능을 말한다. 
이런 그럼 은 본적이 없는데 우리 대게 본거는 데이터를 처리하는 부분에 대해서 프로토콜을 봤는데 좀 깊이 들어가서 네트워크 매니지먼트하고 제어하고 하는 기능들을 어디에 있느냐 얘들은 요렇게 전영역에 걸쳐서 이루어지는 어떤 제어기능이 있음
이속에 호설정이 있다는거임 얘는 네트워크레이어 주소를 활용해서 호설정을함 그다음에 데이터 스위칭하는 부분이 이제 데이터 매니지 먼트임 그다음부터 네트워크 주소를 보는게 아니라 vci 번호만 본다는 얘기는 vci는 이와같이 한링크에서만 의미가 있음 
이거는 네트워크 개념의 주소가 아니라 한링크안에서만 의미가 있는 주소임
바로이게 데이터 링크 레이어에서 정의되는 주소임
그래서 이거는 스위칭은 데이터 링크 레이어 에서 이루어지는 친다. 라고 말하는거임 
나중에 라우터 가보면 라우터가 완전히 네트워크 레이어에서 이루어질 수 있는 스위칭인데 그건 오로지 뭐든 거쳐가는 라우터들이 오로지 목적지 주소 글로벌하게 유니크한 목적지 주소만 가지고 계속 포워딩을 함 그건 그야말로 100% 네트워크레이어에서 이루어지는 스위칭 임 
그런 이제 좋은 질문이고
컨트롤 플레인이 있다는 우리가 더한것도 듣게 됨
이런 스위칭 장비나 네트워크 매니지먼트쪽에 관심이 있는 사람보면
네트워크 장비를 그릴때 데이터 매니지먼트와 컨트롤 파트를 이렇게 구분해서 어떤 장치의 기능을 저런식으로 그림을 그림
주로 데이터 매니지먼트 쪽에만 집중해서 이 과목 내용이 구성됨

그래서 이 가상회선에서 이 우리가 이그림이 각 스위칭 방식별로 조금씩 바뀌는것을 주의깊게 보자
이 많은 내용들이 이 3개 그림속에 설명될 수 있음
마치 회선교환과 같이 설정과 해제 단계가 있는데 요 부분에 보면은 우리가 이 회선교환은 아예 파이프가 쭉 일렬로 연결되어있는데 
이와같이 다끝나고 나서야 보내고 전송받고 나서야 보내고 이 게 바로 스토어 앤 포워드임
패킷이 다 와야지만 그다음 그 출력으로 내보내고 하는게 스토어 앤 포워드 방식
패킷 방식에서 기본적인 전송 메카니즘임

그러다보니까 요정도에 딜레이들을 인제 회선교환에 비해서 추가했음
반면에 패킷 스위칭에서는 이 다 받고난다음에 이제 보낼 링크 쪽을 그때야 살펴보는데 살펴보니까 그쪽으로 나갈 패킷이 많으면 기다려야하는데
여기는 보다싶이 이미 보낼수있는 만큼만 억셉트했기 떄문에 즉시즉시 내보낼 수있는 큐잉딜레이가 없음

그래서 이 딜레이도 대폭 패킷, 데이터그램 네트워크에비해서 
딜레이도 충분히 예측 가능한
그런 스위칭 방식이 되는것이다.

절충이면서 굉장히 그 많이쓰이는 방식임

그다음 주제가 8번에 
8-4절까지 

그다음이 이제 스위치 기능, 기본개념 
서킷 스위칭 패킷 스위칭, 패킷 스위칭에 데이터그램 과 버츄어 서킷 스위칭
기능이고 내부 구조는 어떻게 되어있느냐
스위치에 내부구조는 어떻게 되어 있느냐?
인것을 들여다보는게 8-4절임


## Structure of a switch 
스위치구조임
이게 한 과목으로 대학원으로 한과목으로 나오는데 한절에서 다룸
실제 들어가보면 이런 부분 내용들이 있는데
굉장히 70년대 이후로 수학과 이런 주로 수학쪽에서 많은 일을 함
스위치 구조를 얘기하는데 수학이 왜나오느냐??
수학적인 든든한 지원을 받아서 만들어지고 
그러다 보니까 할 말이 많으니까 한학기 과목이었다.

회선교환기 - 전화망 에 쓰이는 교환기
두가지로 나뉜다.
공간 분할 스위치
시간 분할 스위치로나뉜다.

계속 멀티플렉싱에서는 시간분할 이런거 주파수 분할 이런게 나왔는데
서킷 스위칭에 구조를 말할때 공간 분할 시간분할 스위칭 말한다.

서킷 스위칭이이렇게 나눠지고 뒤에 이제 패킷 스위치 
패킷을 서킷 스위치는 전화망에  쓰이는 교환기들이 크게 나눠진단얘기고
뒤에 패킷 교환에 쓰이는 패킷 교환기는 또다른 얘기가 있음
크게 분류를 염두해 두고 얘기를 들어야함

서킷 스위칭에서 두가지가 있다고 했는데
공간 분할은 말그대로 
패스가 패스를 말한다. 공간이라는게 패스임
각 호마다 데이터가 흘러가야 되는 패스를 서로 분리해놓음
공간분할은
서킷 스위칭은 말그대로 호마다 완전한 파이프 같이 라인을 하나 자원을 완전히 주는거임
전화망
자원을 완전히 할당해주는 길들이 분리되어있는구조임

공간분할
길을 분리한다라는 개념에 스위칭 개념을 가지고 있는게 공간분할 교환이고
시분할은
시간으로나눠서 전송해줌
우리이미 tdm,멀티플렉싱 
프레임에 한채널만이용해서 특정한 호가 가고 다른 호가 새로 
시간분할임
이게 스위칭이라는 얘기가 됨

첫번째 들어온놈을 멀티플렉싱, 디멀티플렉싱해서 
얘를 첫번째 들어왔지만 여기서 뺴갈때는 10번째에서 빼간다라고 하면 스위칭ㅇ ㅣ 이루어짐
첫번쨰 유저 가 보낸 데이터가 받은쪽에서는 10번째 유저 가 이 그 데이터 전송됬다. 이게 바로 스위칭임 이게 바로 프레임 기반에 스위칭이 이루어지는데 그 뒤에 보게 되는데 상상은 할 수있음 tdm 방식은 

저것을 시간을 활용하는거고 공간분할은 정말 패스자체가 분리되어있음 물리적으로
제일 간단한 공간분할 스위치는 크로스바 스위치임
이런 형태로 되어있고 이 접점 마다 릴레이가 있는거임
릴레이 가 붙었다 떨어졌다 하는데 붙어있단 얘기는 여기로 길이 이 데이터가 흘러갈 수있음 
이 접점이 붙어있으면 이 접점들을 다 띄어버리고 
이 접점만 붙어있으면 여기서 들어온 값이 이 접점을 통해서 여기서 내려가서 얘한테 가게됨
동시에 요 이 접점만 살리고 라인에서 요접점 만 살리고 다 뗘버린다고 하면 얘는 요렇게 가서 요렇게 가서 요 1번으로 가게됨
얘는 요 접점만 살리면 요렇게 해서 요렇게 감
릴레이가 이렇게 호가 3개가 있으면 
유저가 3개가 있으면 한순간에 어딘가 3개만 딱 접점이 되어있고 나머지 떨어져 있으면 동시에 3개의 콜이 만들어짐 
바로 이런식으로 패스를 형성해주는 거죠

이런거는 너무 명확하게 패스가 눈에 보임
저 스위치 동작에 의해서
자 여기 ??? 방식(에레게이션 방식?)으로 이렇게 되어있는데 저걸 어떻게 활용하냐면 
이렇게 지금 이 시간이 어느시간에 마치 지금 
그 tdm 프레임 같이 되어있는데
이 라인에 들어있는 큐에 쌓여있는 패킷들이 이렇고 여기있는 패킷들이 이렇다 이거임
근데 이 맨 첫번째 보니까 애는 비어있고 얘는 2번으로 갈려고 하고 얘는 1번 4번으로 갈려고 한다 
여기 1,2,3,4 인데 이렇게 가야하는거죠
그러면 첫번째 요 앞에 있는 놈들을 처리할떄 이 접점이 누구누구 붙어있어야 하고 누군 떨어져야 하고 하는게 바로 이 목적지 들을 보고 우리가 알 수있음 
이 구지 따라가보면은 이런 시뮬레이션이 되겠다.딱
맨앞에있는놈들을 처리할때는 1번 에 들어온놈은 처리할게없음
아무것도 접점이없고 
2번에 들어온놈은 2가 접점이 됨
2에 해당하는 접점
3에서 들어온놈은 1번이 접점이 되고
4번은 4가 접점이 됨
첫번째 패킷을 처리할때는 time slot 1이라고 해서 요런 접점이 이루어지고 
그다음 접점은 1,3,2 면은 그다음 순간에는 접점이어느게 붙어야 하는지 우리가 볼 수있음
저 그떄그떄 time slot 하나 하나 처리할때마다 이렇게 접점이 확달라진다. 
그리고 스위치가 막 이루어짐 스위칭이
이런식으로 굉장히 다른 시간동안 저 타임슬랏별로 스위칭이 이루어지는 방식
이건 동시에 크로스바구조는 동시에 인풋개수만큼 호가 형성될 수 있음 
서로 블락킹 없이 아주 럭셔리한 스위치임

블락킹 없이 모든 유저가 다 빠져나갈길이 다 있는 
어느 순간에서든
그대신
크로스바 스위치 단점은 이 접점에 스위치 하나하나가 너무 많음
인풋 개수 * 아웃풋 개수만큼의 이 접점이 있어야함
인 풋이 1000개 아웃풋이 1000개 
천개 의 유저가 쓰고 아웃풋이 1000개가 나가면 
나가야될 길이 1000개 있으면 접점이 백만개가 있어야함
크로스바 접점의 개수가
입력보다 출력이 많거나 같아야 함
많을 수도있음
출력이야뭐
얘와 얘가 똑같아야한다는 필요가없음
나갈길이 적으면안되겠다
적어도 적다면은 분명히 어느 같은 목적지를 가는 이 유저두개가 있을 수 있는데 어떤 컨트롤이 있어야겠다.
그 순서를 정해준다던지
그리고 중요한게 패킷 스위치 된게 마치 이 렇게 지금 
타임 슬랏이라고 말하는데 이게 
이게 동일한 시간에 하나씩 하나씩 처리된다는 얘기는 지금 요기에 쌓여있는 처리될 패킷들에 크기가 동일해야 함
근데 여기 서킷 스위칭을 얘기하고있음
서킷 스위치는 패킷 스위치와 같이 패킷 사이즈 안해왔는데
서킷 스위치에서도 마치 동일 해야 얘기가 됨
싱크가 다 맞아야 하니까 

한 슬랏에 각각 다 처리되어야 하고
그다음에 또 처리되어야 하고
동일한 사이즈여야 되는데 그러면 서킷 스위칭인데 이게 어떻게 가능하냐 당연히
이 스위치가 우리는 모르지만 스위치가 이런 구조 로 되어있다면
긴 1000byte짜리를 이런식으로 맞게끔 똑같은 사이즈로 내부에서 내부에서 조절한다음에 
다시 아웃풋에서 다시 조합을 해서 처리함
들어갈떄 나갈때는 큰 사이즈가 맞는데 안에서 스위칭 되기위해서 그것을 스위치가 알아서 잘게 쪼개고 동일 한 사이즈로 쪼개고 
그것을 스위칭을 통해서 동일 을 맞춰서 스위칭한다음에 다시 묶어서 보냄
이런 게 얘기가 되야 뒤에 스위치들에 동작을 다 얘기할떄 다 이게 적용이됨
이 부분은 생략되어있음 설명에
이 스위치 내부에서 어떤 빠른 교환이 이루어지기 위해서는 
내부에서 다루어지는 그 데이터 사이즈는 다시 동일한 크기로 이 처리되게
나누어서 처리된다라는게 전제가 되어있음

실제 그래야 이런게 가능함
이 크로스바 단점은 이 크로스바 접점의 개수가 이 인풋 개수 * 아웃 풋 
굉장히 많은데 바로 이제 그 70년대 부터 고민을하고 고생을 한 사람들이 크로스바 접점의개수를 줄이면서도 어떻게 여기로 부터 입력으로부터 출력까지
자기 패스가 보장이 되게끔 할 수있을까?
가장 간단한 이 크로스바에는 너무 간단하지만 접점이 너무 많다. 거의 비슷한 성능을 보여주는데 크로스바 의개수를 줄이는 방법을 연구했는데 멀티스테이지 스위치임

## Multistage switch
여기 인풋이 n개 라지 n개가있고 아웃풋이n개가있으면 크로스바 스위치는 n^2 개의 크로스바 접점이있어야 하는데 이렇게 stage 를 3개 stage로 나눴음
그리고 요 각각 크로스바 
각각, 노란박스는 크로스바 스위치인데 여전히
여전히 여기는 n개가 들어와서 뭐 여기 중간에 하나씩 ?
k개가 있음
여기는 바로 이런 스위치 구조를 왜 이게 스위치가 왜 나왔으며 이 스위치 구조를 분석하고 하느냐고 시간이 필요한데 
거기까지 들어갈게 아니고
이런 아이디어 가있음
크로스바를 n*n 짜리 큰거 쓰는것보단 
n by n 인풋이 n개고 아웃이 n개면
n sqare 의 크로스 포인트가 있어야댐
n sqaure 저렇게 노란게 각각 크로스포인트이면서 저렇게 stage를 나눠보면 훨씬 적은 숫자의 크로스 포인트를 갖고도 이 크로스 포인트 구조가 제시해주는 성능 
모든 인풋은 모든 아웃풋으로 갈길 을 만들어주는거 이게 보장이됨
그런걸 보장이 되면서 크로스바 개수를 노력이 고생함
굉장히 스위치 구조하나가 연구대상이 있었음

첨자 잠깐 보면은 
이 first stage에 N/n개 그러니까 이 각각의 작은 크로스바 가 
n by 요기가 k개가 있으면 두번쨰 stage에 k개가 있으면
두번째 stage 에 적어도 하나씩 연결선을 가지고 있으려면 output은 k개가 있어야댐 
노란게 노란게 k개가 있으면
각이 크로스바는 k개의 output  이있어야하고 
요 input은 내가 하기 나름인데 small n개 만큼만 다 할당해준다.
그럼 이 사이즈는 small n by k이고 이 몇개 있느냐 N/n 임 이게 
N/n 개 이렇게 만들어지고 
여기 k개가 있다고 가정하면 이 k개의 크로스바 각각에 크로스바 디멘션은 어덯게 되냐면 요기 몇개 들어오냐면 인풋이 요기 개수만큼 들어옴
이거 개수가 N/n임 (중간 스테이지 얘기하는거임)

output은 이것과 똑같은 이런 이미지
출력 쪽에 있는 3번째 stage는 input의 stage와 똑같음
역시 N/n개가 있음 그러면 요 중간에 있는 단계에서 각각의 output 크로스바로 나갈수있는 길은 하나씩 있어야 연결이될거아니야
그래서 나가는 길이 N/n개 그래서 이렇게 k개 있는 중간 단계 stage에는 N/n * N/n개가 그런 스위치가 크로스바가 k개가 있고 여기는 다시 이것과 똑같은 사이즈가 있는것이고 
그러면 앉아서 전체크로스바가 몇개냐? 
계산을 n과 N 과 small n 과 k로 표현되는 이 크로스바 스위치 개수가 나옴
나오겠음
이만큼이나옴
지금 본 3개 stage에서 이 여러분들이 다계산해보면 크로스바 스위치가 이만큼 나옴
이거와 n sqare와 비교해보면 
2*k*N + k(N/n)^2 굉장히 작아줌 much smaller 
개수라는거임
이렇게 그리라고 하면
근데 아직은 빈 치수가 있는거임
small n을 몇개로 할꺼며
중간단계에 있는 크로스바 스위치를 몇개로 할꺼며
자 그 몇개를 할껀가를 결정할떄 뭐가 지금 염두해 둬야 하냐면 
크로스바 스위치가 제공해준 
모든 input 에게 모든 output을 갈 수 있는길이 
제공되는거
이 기능이 제공되도록 하면서 n과 k를 결정해야함
어려운말임
n과 k를 아무숫자나 결정하는게 아니라 그 길이 열리도록 만들어줘야함
k 
과연이 중간 stage에 몇개가 있어야 될까
몇개가 있어야 될까 
몇개가 있어야 어느 input으로 들어온놈이 어느 output이든 나갈 수 있는길이 항상 보장이 될까? 
항상 보장된다는게 가령 여기서 여기로 나가는길이 지금 첫번째 크로스바 여기로나가는놈은 길이 하나밖에없음
하나 
그럼 동시에 이놈들이 요기로 갈 수있는 놈은 하나 밖에 못감 그럼 동시에 두개의 input이 가령 여기 를 통해서만 나가야 된다고 하면 blocking이됨 패스가 제공이 안됨 
그경우에는 한놈은 이리로 가고 한놈은 다른길로 나간다음에 여기서 또 어떻게든 내가 원하는쪽으로 갈 수 있게 이 길을 뚫려 있어야 함 바로이 require ment를 고려했을떄 과연 k개가 몇개가 있어야할까를 먼저 생각을 해야함 
k가 
k개를 몇개있어야 할지 생각하는것은 여러분들이 답을 가르쳐주면 너무 쉬운데 생각을 하면 과정이 필요하다.
그래서 답은 있음

## 메모
먼저 이 
cross point 개수가 줄어들었는지 보는 example 이 하나 있음
예를들어서 200by 200 스위치다. 그럼 N이 200이다.
그럼 크로스포인트는 4만개가 필요함
크로스 포인트 스위치 하나로 썻다면 
그런데 지금 이 경우에 가정을 하는거임
k, 중간단계에 4개 크로스바 스위치를 두고 앞에 small n을 20으로 뒀단 얘기는 이 앞에 10개씩을 만들었단 말임
앞에 10개씩 
small n을 20을 두면 전체가 200이니까 여게 10개가 있어야함 
이 10개 여기는 4개 
여기도 10개 
했을때 숫자를 크로스포인트 개수 구하는 수식에 집어넣어보면은 
여기다 집어넣어보면 2000개 
4만개 -> 2천개 로 줄어든다.
근데 뭐 마냥 좋아할건 아님 정말 줄어들엇는데 정말 
패스가 제공되느냐 이게 중요
그다음 살펴보는게 과연 조건이 어떻게 되느냐 k라는거에 대한 조건
그리고 그 k가 주어졌을때 k가 주어졌을떄 k와 n은 어떤 관계냐 
자 이 k가 가령 4개다. 그거하고 n하고 별 상관이 없어보임
k가 4개다 그러면 여기는 아웃풋이 4개가 있으면됨
이런게 4개가 있으면
4개로 나갈길이 있는데 인풋은 몇개냐 small n임 n은 여전히 안정해져 있는 상태임 
k가 정해졌다고 n이 저절로 정해지는게아님 
그럼 k도 정하고 n도 정함
두개 우리 지금 2개 정해야 할 게있음
근데 다행스럽게 k에 대해서는 명확히 정해졌다.
k에 대해서는 이 clos 라는 사람이 번뜩이는 아이디어로 이만큼이 필요하다 라고 말했음 k는 n이 지금 먼지 모르지만 n이 정해지면 이 2n-1 개 이상만 있으면 어떤 뭘 보장하냐?
모든 인풋이 어떤 아웃풋이든 갈 수 있는길을 만들 수 있다 라는 그런거를 cLos criterion 이라고 말함
제시한 조건임
그러면 그다음할일은 k값이 이거 이상이라고 하면
최소한 2n-1 이라는값을 넣어보는거임 
그다음 할일이 머냐
이식에 k개 가 2n-1 값이 되는거임
최소한 최소 필요한 2n-1값을 우리가 택해도 만족함
2n-1 을 넣을때 과연 n은 어떤 숫자를 정할까? n은 어떻게 정하느냐 k가 저것을 만족하는 모든 인풋으로 모든 아웃풋으로 갈수있는 길이 보장된다 이거임
그러면 보장이 됬으면 내가 원하는것은 크로스 포인트 개수 가 k가 이만큼 일때 크로스포인트개수가 최소이면은 내가 원하는거임
그러니까 모든 길을 제공해주면서도 그떄 k를 이걸 이값을 집어넣으면 이식은 n과  N만 남음
k에 n값을 넣어서 대입을 했으니까 
그럼 N은 정해져있음 이 스위치가 인풋이 몇개 아웃풋이 몇개
똑같은 스퀘어라고 하면 인풋이 만개다 정해진거임
미지수는 n이라는거임
바로 n에 대한 식이 되는데 내가 원하는것은 크로스포인트가 최소가 될떄 
이 식을 n으로 미분을해서 n에 대한 최소값을 
이값이 함수가 최소가 되는 n을 찾으면 내가 최종적으로 n과 k를 구하는 셈이 되는것이다. 
그런식으로 해서 n과 N이 나오면 스위치구조 가 완성
인풋을 첫번째 단계에서 몇 바이 몇으로 쓰고 중간 단계 스위치를 K개를 두고 스위치가 다나옴
우리가 할일이 바로 
CLOS 라는 사람이 이것을 제시했는데 이것이 어떻게 나왔을까
사실 여러분 인터넷 뒤져보면 나옴
이 나옴 거기 설명이 있을테니까 공부를함
왜냐왔을지 이해함
그리고 이것을 대입해서 아까 최소에 n값이라고 했는데 크로스포인트를 최소화하는 n값을 구해보는데 이게 나온다는거지 (N/2)^(1/2)그 크로스 포인트 개수를 최소화하는게 k를 이렇게 저거 하고 나면 (N/2)^(1/2) 되면은 그 크로스포인트 개수를 표현하는 식은 최소다 이거임

바로 요 것을 유도해야하고 
이게 왜나왔을까 설명할 수 있어야함
다음 시간까지 숙제임
