---
post : layout
title : 컴퓨터구조(기)2
---
## 컴퓨터구조(기)2
컴퓨터구조(기)2

## 문제해설
fetch는 memory에서 instruction을 가져오는것이다. 가져와서, ir (instruction register)에다 집어넣는다. 그래서 pc가 프로그램 주소를 담고있고 이 주소에 해당되는 메모리 내용 이게 명령어다. 가져와서 ir에 넣는것을 동작하고 pc를 그다음 명령어 위치로 4만큼 증가시키는 동작이 필요하다. fetch에서는 

7. pc의 브랜치에 결과에 따라서 pc값을 바꿀지 말지를 결정하는 데이터 있는데 conditional branch일 경우에 condition에 따라서 write를 해야한다 사실을 알려주는 신호다. (PCWritecond)

9. lw, sw 중에 걸리지 않는선, pcwritecond는 branch에 필요한 선이다. IRWrite는 instruction fetch에서 instruction이 담겨야 하니까 쓴다. 

## Finite State Machine Diagram
state가 정해지면 그 state에서 밖으로 출력해야할 제어신호들이 다 정의되어 있다. 8번 state에 갔다 그러면 여기서는 이런 값들을 내야한다는게 이미다 정해져있다. 이것을 만들면 어떻게 만들 수 있냐

## Finite State Machine Controller
메모리 번지라고 생각하자. 8번지에가면 이런값들이 들어있는데, 이값들을 쭉 출력시켜주면된다. 이 값들을 미리 정해놓으면된다. 1000, 1010 이런식으로 해당되는 값을 비트패턴으로 그러면, 여기 사용되는 모든 신호들이 합치면 30여개가 되는데 30bit를 설정해두고 30bit에 해당되는곳에 0,1,0,1 패턴을 두고 그것을 쭉 계속해서 자기 state에 왔을때 자기에게 해당되는 30bit의 값을 출력시켜주면된다.(30bit 안에서 자기 state에 해당하는 값인거 같다..) 

이것을 구지 디지털 로직으로 만들어보겠다 하면, 전체적으로 따지면 순차회로다. 여기에 state register라는 기억장소를 가지고 있기 때문에 전체로따지면 순차회로다. 순차회로와 조합회로의 차이는 조합회로는 자기 상태라는것이 없다. 항상 어떤 입력값에 의해서 출력값이 결정된다. 여기서는 입력값으로 opcode, 6bit가 들어온다. 그것에 의해서만 출력이 결정되는것이 아니고, 그 opcode와 함께 현재 내가 있는 state 알아야 내 state에서 이런값이 들어오면 이렇게 내보내야해가 정의되어있는것이다.(이런값이라는건 현재 state에서 opcode가 들어오면 이란것으로 이해가 된다..)

그래서 이게 순차회로다.
순차회로 안에서도 이 control, box만 놓고보면 이 파트는 조합회로다. 순차회로는 조합회로+메모리가 순차회로다. 이 조합회로는 입력과 출력을 결정한다. 입력은 opcode, 6bit 한 부분이고 또 입력이 current state 번호다. state가 9개 있는데 4bit로 state 번호를 부여했다. 0번부터 9번까지 4bit로 표현했다. 그래서 input은 opcode 6bit, state 4bit, 총 10bit가 들어온다. 그러면 출력이 결정된다. 출력이 중요한게 중간에 2bit 짜리 인것도 있음 그러니까 20bit 정도 되는데 그것에 신호선 값하고 또하나 next state가 필요하다. 내가 지금 0번입니다. 다음 state는 볼것도 없이 1번이다. 1번 이고, 그 다음에는 내가 branch면 8번으로 가고 load 면 3번으로 간다. 그래서 다음 가야될 state number가 여기에 나와야 한다. 그게 next state라는 state 번호다. 이것을 테이블로 그리면

이렇게 그려볼수있다.
## table
여기를 기준으로해서 왼쪽이 입력이다. 오른쪽이 출력이다. state가 0번이면 opcode값 볼것도 없이 이렇게 내보내야 한다. (신호들을 의미하는듯) next state는 볼것도 없이 0001을 내보내야 한다. 그다음에 현재 0001이면 만약에 opcode가 r-format이면 현재 0001이면 내보내야할 신호값들은 
동일하다. 0001, 1번 state에서는 항상 memRead는 얼마가 되야 할까? 정의된것이 없으면 don't care다. regWrite는 don't care다. ALUScrB1, ALUSrcB2, ALUSrcA 각각 1/1/0 이다. ALUop=00 이다. memRead, RegWrite는 여기서 don't care다. 그다음에 ALUSrcA는 0 ALUSrcB=11이다. 현재 state가 다 1번이라는 말이다. 그때 지금 가져온 명령어의 opcode가 다이렇다. 사실은 1번 state에서는 명령어에 따라서 출력이 ++같다++ 1번은 instruction decode이기 때문에 명령어하고 상관없이 다 하는일은 같다. 그러니까 얘들은다 같은 값이 여기 채워지면 된다. 다만, 현재 1번에서 다음 next state가 몇번이 출력될지 달라진다. 1번에서 가져온 명령어가 r-format이면 next state는 몇번이로 가야 하겠냐? 6번으로 가야한다. 0110이 되는것이고(next state) 그다음에 load 일경우 현재 1번인데 가져온 명령어가 load일때는 2번으로 가야한다. store도 역시 2번으로 가야한다. 