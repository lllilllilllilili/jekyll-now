---
post : layout
title : 파일 입출력
---
## c언어
c언어

## 파일과 스트림(stream)
스트림(stream) : 프로그램과 참좋할 데이터가 저장되어 있는 파일 사이에 데이터가 이동할 수 있는 다리를 놓는 일이다.(운영체제에 의해서 형성)

## FILE * fopen(const char * filename, const char *mode)
해당 파일과 스트림을 형성하고 스트림 정보를 FILE 구조체 변수에 담아 변수의 주소 값을 반환한다. 앞에 FILE은 기본자료형이 아니므로, 구조체다.

파일 포인터를 이용해서 파일에 데이터를 저장하거나 파이엘 저장된 데이터를 읽게된다.
(FILE 구조체 변수에는 파일에 대한 정보가 있다.)

## 입력스트림과 출력스트림의 생성
스트림은 한 방향으로 흐르는 데이터의 흐름을 의미(입력스트림, 출력스트림 구분)
fopen은 파일이 개방(오픈)되었다.

## fclose 함수
파일을 닫아줘야 하는 이유는 크게 2가지다.
운영체제가 할당한 자원의 반환과 버퍼링 되었던 데이터의 출력(출력버퍼, 입력버퍼가 존재하는데 디스크에 들어가기전에 버퍼에 남아있으므로, 반드시 close 해줘야한다.)

## fflush 함수
fflush 함수는 출력버퍼를 비우는 함수다.

## 텍스트파일과 바이너리 파일
사람이 인식할 수 있는 문자를 담고 있는 파일을 가리켜 텍스트파일(text file)
컴퓨터가 인식할 수 있는 데이터를 담고 있는 파일을 가리켜 바이너리 파일(binary file)

## 이해하기 어려웠던 코드
```
#include <stdio.h> 

int main(void) {
   char name[10];
   char sex;
   int age;

   FILE * fp = fopen("friend.txt", "rt");
   int ret;

   while (1) {
      
      ret = fscanf(fp, "%s %c %d", name, &sex, &age);
      if (feof(ret) != 0) {
         printf("%s %c %d \n", name, sex, age);
         break;
      }
      else
         printf("파일 읽기 실패");
   }
   fclose(fp);
   return 0;
}

```
```
#include<stdio.h>

typedef struct fren
{
   char name[10];
   char sex;
   int age;

}Friend;

int main(void) {
   FILE * fp;
   Friend myfrine1;
   Friend myfrine2;

   
   fp = fopen("friend.bin", "wb");
   printf("이름,성별, 나이 순 입력 : ");
   scanf("%s %c %d", myfrine1.name, &(myfrine1.sex), &(myfrine1.age));
   fwrite((void*)&myfrine1, sizeof(myfrine1), 1, fp);
   fclose(fp);

   fp = fopen("friend.bin", "rb");
   fread((void*)&myfrine2, sizeof(myfrine2), 1, fp);
   printf("%s %c %d \n", myfrine2.name, myfrine2.sex, myfrine2.age);
   fclose(fp);
   return 0;

}
```
```
#include<stdio.h.>

int main(void)
{
   FILE * fp = fopen("text.txt", "wt");
   fputs("123456789", fp);
   fclose(fp);

   fp = fopen("text.txt", "rt");

   fseek(fp, -2, SEEK_END);
   putchar(fgetc(fp));

   fseek(fp, 2, SEEK_SET);
   putchar(fgetc(fp));

   fseek(fp, 2, SEEK_CUR);
   putchar(fgetc(fp));

   fclose(fp);
   return 0;
}
```
```
#include <stdio.h>

int main(void) {
   long fpos;
   int i;

   FILE * fp = fopen("text.txt", "wt");
   fputs("1234-", fp);
   fclose(fp);

   fp = fopen("text.txt", "rt");

   for (i = 0; i < 4; i++) {
      putchar(fgetc(fp));
      fpos = ftell(fp);
      fseek(fp, -1, SEEK_END);
      putchar(fgetc(fp));
      fseek(fp, fpos, SEEK_SET);

   }
   fclose(fp);
   return 0;
}
```